<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Abstract_machine (compiler.Abstract_machine)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">compiler</a> &#x00BB; Abstract_machine</nav><header class="odoc-preamble"><h1>Module <code><span>Abstract_machine</span></code></h1><p>Module defining the abstract machine on which our language is executed. It defines the type of elements manipulated by the machine, two modules defining its memory, its basic operations, and exceptions that it can raise.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-value"><a href="#type-value" class="anchor"></a><code><span><span class="keyword">type</span> value</span><span> = </span></code><ol><li id="type-value.VInt" class="def variant constructor anchored"><a href="#type-value.VInt" class="anchor"></a><code><span>| </span><span><span class="constructor">VInt</span> <span class="keyword">of</span> int</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>integer value</p><span class="comment-delim">*)</span></div></li><li id="type-value.VFloat" class="def variant constructor anchored"><a href="#type-value.VFloat" class="anchor"></a><code><span>| </span><span><span class="constructor">VFloat</span> <span class="keyword">of</span> float</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>floating point value</p><span class="comment-delim">*)</span></div></li><li id="type-value.VBool" class="def variant constructor anchored"><a href="#type-value.VBool" class="anchor"></a><code><span>| </span><span><span class="constructor">VBool</span> <span class="keyword">of</span> bool</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>boolean value</p><span class="comment-delim">*)</span></div></li><li id="type-value.VArray" class="def variant constructor anchored"><a href="#type-value.VArray" class="anchor"></a><code><span>| </span><span><span class="constructor">VArray</span> <span class="keyword">of</span> string * <span><a href="#type-value">value</a> <a href="../Util/Environment/index.html#type-t">Util.Environment.t</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Array value. VArray(name,size,env) states that the array values are stored in environment env in cells &quot;&lt;name&gt;#0&quot; to &quot;&lt;name&gt;#&lt;size&gt;&quot;.</p><span class="comment-delim">*)</span></div></li><li id="type-value.VNone" class="def variant constructor anchored"><a href="#type-value.VNone" class="anchor"></a><code><span>| </span><span><span class="constructor">VNone</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>undefined value (uninitialized or error value)</p><span class="comment-delim">*)</span></div></li></ol></div><div class="spec-doc"><p>Type representing the different elements the abstract machine can manipulate. <code>VNone</code> should only be used for uninitialized values.</p></div></div><div class="odoc-spec"><div class="spec exception anchored" id="exception-Wrong_type_operand"><a href="#exception-Wrong_type_operand" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Wrong_type_operand</span> <span class="keyword">of</span> string * <a href="#type-value">value</a> * <a href="#type-value">value</a></span></code></div><div class="spec-doc"><p>Exception that should be raised whenever the abstract machine is asked to perform an operation over two elements on which it does not apply. It contains a message, and the two values on which the operation was applied.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-string_of_value"><a href="#val-string_of_value" class="anchor"></a><code><span><span class="keyword">val</span> string_of_value : <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Function that gives a textual representation of a value. For arrays, assumes that tab<code>i</code> is stored in name &quot;tab#i&quot;.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-value_of_string"><a href="#val-value_of_string" class="anchor"></a><code><span><span class="keyword">val</span> value_of_string : <span>string <span class="arrow">&#45;&gt;</span></span> <a href="#type-value">value</a></span></code></div><div class="spec-doc"><p>Function that convert a textual representation of a value into said value. Only works for integer, floats and booleans.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-parse_complex_argument_and_affect"><a href="#val-parse_complex_argument_and_affect" class="anchor"></a><code><span><span class="keyword">val</span> parse_complex_argument_and_affect : 
  <span><span><a href="#type-value">value</a> <a href="../Util/Environment/index.html#type-t">Util.Environment.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p><code>parse_complex_argument_and_affect map name argument</code> converts <code>argument</code> into a value and attributes it to <code>name</code> inside <code>map</code>. If <code>argument</code> is the representation of an array as &quot;[v0,v1,...,vk]&quot;, it associates <code>name</code> to an array of size k+1 and associates each value vi to <code>name</code>#i. It doesn't support arrays of arrays.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_value_environment"><a href="#val-pp_value_environment" class="anchor"></a><code><span><span class="keyword">val</span> pp_value_environment : 
  <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-value">value</a> <a href="../Util/Environment/index.html#type-t">Util.Environment.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p>Pretty-printer function for <a href="#type-value"><code>value</code></a> <a href="../Util/Environment/index.html#type-t"><code>Util.Environment.t</code></a>, to see what the interpreter is doing.</p></div></div><p>In the following are the basic operations that the machine can apply to values. All of them behave the same way: if the operation is <code>op</code>, <code>op v1 v2</code> returns the result of the operation applied to <code>v1</code> and <code>v2</code> if it is applicable, and raises an exception <code>Wrong_type_operand(&quot;op&quot;,v1,v2)</code> if it is not applicable because of its type : e.g., <code>add_i (VFloat 1.0) (VBool true)</code> will raise <code>WrongTypeOperent(&quot;add_i&quot;,(VFloat 1.0),(VBool true))</code>. On the contrary, <code>div_i (VInt 14) (VInt 0)</code> will raise <code>Division_by_zero</code>, as the functions do not check that the OCaml operation called does not raise it).</p><div class="odoc-spec"><div class="spec value anchored" id="val-add_i"><a href="#val-add_i" class="anchor"></a><code><span><span class="keyword">val</span> add_i : <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-value">value</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sub_i"><a href="#val-sub_i" class="anchor"></a><code><span><span class="keyword">val</span> sub_i : <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-value">value</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mul_i"><a href="#val-mul_i" class="anchor"></a><code><span><span class="keyword">val</span> mul_i : <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-value">value</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-div_i"><a href="#val-div_i" class="anchor"></a><code><span><span class="keyword">val</span> div_i : <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-value">value</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mod_i"><a href="#val-mod_i" class="anchor"></a><code><span><span class="keyword">val</span> mod_i : <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-value">value</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-add_f"><a href="#val-add_f" class="anchor"></a><code><span><span class="keyword">val</span> add_f : <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-value">value</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sub_f"><a href="#val-sub_f" class="anchor"></a><code><span><span class="keyword">val</span> sub_f : <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-value">value</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mul_f"><a href="#val-mul_f" class="anchor"></a><code><span><span class="keyword">val</span> mul_f : <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-value">value</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-div_f"><a href="#val-div_f" class="anchor"></a><code><span><span class="keyword">val</span> div_f : <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-value">value</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mod_f"><a href="#val-mod_f" class="anchor"></a><code><span><span class="keyword">val</span> mod_f : <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-value">value</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-and_b"><a href="#val-and_b" class="anchor"></a><code><span><span class="keyword">val</span> and_b : <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-value">value</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-or_b"><a href="#val-or_b" class="anchor"></a><code><span><span class="keyword">val</span> or_b : <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-value">value</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-not_b"><a href="#val-not_b" class="anchor"></a><code><span><span class="keyword">val</span> not_b : <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-value">value</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-eq_m"><a href="#val-eq_m" class="anchor"></a><code><span><span class="keyword">val</span> eq_m : <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-value">value</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-lt_m"><a href="#val-lt_m" class="anchor"></a><code><span><span class="keyword">val</span> lt_m : <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-value">value</a></span></code></div></div></div></body></html>
